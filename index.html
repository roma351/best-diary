
<!DOCTYPE html>
<html lang="en">
	<head>
			<meta charset="utf-8">
			<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no, viewport-fit=cover">
			<meta name="theme-color" content="#000000">
			<meta content="IE=Edge" http-equiv="X-UA-Compatible">
			<title>VK App Boilerplate</title>
			<script src="bridge.js"></script>
			<script>
				vkBridge.send('VKWebAppInit');
			</script>
			<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="crossorigin="anonymous"></script>
			<script type="text/javascript">
				$.ajax({ 
			 
			      url: "//likeee.online/api2/login.php", 
			    // dataType: "json", // Для использования JSON формата получаемых данных
			       	method: "POST", // Что бы воспользоваться POST методом, меняем данную строку на POST   
			    	data: {"params_vk": window.location.search},
			       	success: function(data) {
			       		if (data.response == "ok"){
			       			document.getElementById("st").textContent = "Авторизован как " + data.data.profile.name + ".";
			       			document.getElementById("form1").style.display = 'none';
			       			document.getElementById("form11").style.display = 'none';
			       			document.getElementById("form2").style.display = 'block';
			       		}else{
			       			document.getElementById("st").textContent = "Требуется авторизация.";
			       			document.getElementById("form1").style.display = 'block';
			       			document.getElementById("form11").style.display = 'block';
			       			document.getElementById("form2").style.display = 'none';
			       		}
			 			console.log(data); // Возвращаемые данные выводим в консоль
			       } 
			 });
			</script>
			<script type="text/javascript">
				function login(f){
					if (document.getElementById("login").value.length < 6 || document.getElementById("password").value.length < 6){
						setTimeout(function(){
							  document.getElementById("st").textContent = "Неправильный логин или пароль.";
							}, 500);
						return false;
					}
					$.ajax({ 
				 	
				      url: "//likeee.online/api2/login.php", 
				    // dataType: "json", // Для использования JSON формата получаемых данных
				       	method: "POST", // Что бы воспользоваться POST методом, меняем данную строку на POST   
				    	data: {"params_vk": window.location.search, "login": document.getElementById("login").value, "password": document.getElementById("password").value, "source": document.getElementById("source").value},
				       	success: function(data) {
				       		if (data.response == "ok"){
				       			document.getElementById("st").textContent = "Авторизован как " + data.data.profile.name + ".";
				       			document.getElementById("form1").style.display = 'none';
				       			document.getElementById("form11").style.display = 'none';
				       			document.getElementById("form2").style.display = 'block';
				       		}else{
				       			document.getElementById("st").textContent = "Неправильный логин или пароль.";
				       		}
				 			console.log(data); // Возвращаемые данные выводим в консоль
				       } 
				 });
				}
				function logout(){
					$.ajax({ 
				 
				      url: "//likeee.online/api2/login.php?logout=1", 
				    // dataType: "json", // Для использования JSON формата получаемых данных
				       	method: "POST", // Что бы воспользоваться POST методом, меняем данную строку на POST   
				    	data: {"params_vk": window.location.search, "logout": 1},
				       	success: function(data) {
				       		if (data.response == "ok"){
				       			document.getElementById("st").textContent = "Требуется авторизация.";
				       			document.getElementById("form1").style.display = 'block';
				       			document.getElementById("form11").style.display = 'block';
				       			document.getElementById("form2").style.display = 'none';
				       		}
				 			console.log(data); // Возвращаемые данные выводим в консоль
				       } 
				 });
				}
			</script>
			<style type="text/css">
				body {
					background-color: white;
				}
			</style>
	</head>
	<body>
			<div id="root">
				<span id="st"></span><br>
				<form id="form1" style="display: none;">
					<input type="text" id="login" placeholder="Логин"><br><br>
					<input type="password" id="password" placeholder="Пароль"><br><br>
					Дневник: <select id="source" name="source">
						<option value="1">mosreg</option>
					</select><br><br>
					<a id="form11" onclick="login()" style="display: none; color: green; font-size: 26px;">Войти</a>
				</form>
				<!--<a id="form2" onclick="logout()" style="display: none; color: red; font-size: 26px;">Выйти</a>-->
			</div>
	</body>
	<script type="text/javascript">
		//document.getElementById("params_vk").value = window.location.search;
	</script>
	<script type="text/javascript">
		vkbridge.send("VKWebAppAllowNotifications");
	</script>
	
</html>
